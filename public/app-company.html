<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Ascent">
    <meta name="author" content="">
    <link rel="icon" href="/resources/bootstrap/favicon.ico">

    <title>Ascent</title>

    <!-- Bootstrap core CSS -->
    <link href="/resources/bootstrap/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/resources/bootstrap/dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/resources/bootstrap/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	<style>
		.fonty {
			color: #5e5e5e;
		}
		.btn-info: {
			background-color: #5e5e5e;
		}
		.icon {
			width: 40px;
			height: 40px;
			color: green;
		}
		.odd {
		  background-color: #eee;
		  height: 10px;
		}
		.even {
		  background-color: white;
		}	
	</style>
  </head>

  <body>
    <div id="wrapper" ng-app="companyApp" ng-controller="companyCtrl">
        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0;  background-color: #5e5e5e;">
			<headertag></headertag>
			<leftmenu></leftmenu>
		</nav>
		<div id="page-wrapper">
			<div class="row">
				<div class="col-lg-12">
					<h1 class="page-header fonty">Manage Company</h1>
				</div>
				<div class="col-lg-12" ng-if="showCreateCompany">
					<div class="col-sm-4 fonty">
						<form role="form" action="createcompany" method="post">
							<div class="form-group">
								<label>Name</label>
								<input class="form-control" name="name" maxlength="200">
							</div>
							<div class="form-group">
								<label>Address</label>
								<textarea class="form-control" name="address"></textarea>
							</div>
							<div class="form-group">
								<label>Status</label>
								<div class="radio">
									<label>
										<input type="radio" name="active" id="active" value="true" checked="true">Active
									</label>
								</div>
								<div class="radio">
									<label>
										<input type="radio" name="active" id="inactive" value="false">In-Active
									</label>
								</div>
							</div>
						</form>
						<a href="#" onclick="document.forms[0].submit()" class="btn btn-xs btn-success">
							Create User
						</a>
						<button class="btn btn-xs btn-default" type="button" ng-click="loadCompanies()">
							Cancel
						</button>						
					</div>
				</div>
				<div class="col-lg-12" ng-if="showCompanyList && !showCreateCompany">
					<table class="table fonty">
						<thead>
						  <tr>
							<th>Company Code</th>
							<th>Name</th>
							<th>Status</th>
							<th>Active</th>
							<th>Operation</th>
						  </tr>
						</thead>
						<tbody>
						  <tr ng-repeat="company in companylist | orderBy : 'name'" ng-class-odd="'odd'" ng-class-even="'even'">
							<td>
								<span class="">{{company.company_code}}</span>
							</td>
							<td>
								<span class="">{{company.name}}</span>
							</td>
							<td>
								<span class="">{{company.status}}</span>
							</td>
							<td>
								<span  ng-if="company.active" class="">Active</span>
								<span  ng-if="!company.active" class="">In-Active</span>
							</td>				
							<td>
								<button class="btn btn-xs btn-primary" type="button" ng-click="goToContacts(company)">
									Contacts
								</button>
								<button class="btn btn-xs btn-primary" type="button" ng-click="goToBatches(company)">
									Batches
								</button>						
								<button class="btn btn-xs btn-primary" type="button" ng-click="goToEditCompany(company)">
									Edit
								</button>							
							</td>
						  </tr>		  
						</tbody>
				  	</table>	
				  	<button class="btn btn-xs btn-success" type="button" ng-click="goToAddCompany()">
						Create New Company
				  	</button>	
				</div>
			</div>
		</div>
	</div>
	<!-- Angular -->
	<script src="/resources/angular/angular.min.js"></script>
    <!-- jQuery -->
    <script src="/resources/bootstrap/vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/resources/bootstrap/vendor/bootstrap/js/bootstrap.min.js"></script>
  </body>
</html>
<script>
	var company = angular.module('companyApp', []);
	company.directive('headertag', function($compile) {
		var directive = {};
		directive.restrict = 'E';
		directive.templateUrl = "/resources/templates/header.html";		
		directive.controller = function($scope, $rootScope, $http) {
				
		};		
		return directive;
	});
	company.directive('leftmenu', function($compile) {
		var directive = {};
		directive.restrict = 'E';
		directive.templateUrl = "/resources/templates/app-left-menu.html";		
		directive.controller = function($scope, $rootScope, $http) {
			$scope.dasboardtab = 'active';		
		};		
		return directive;
	});	

	var companyController = function($scope, $http){
		$scope.loadCompanies = function(){
			$scope.showCreateCompany = false;
			$scope.showCompanyList = false;
			$scope.companylist = [];
			$http.get("/getcompanies")
			.then(function(response) {
				$scope.showCompanyList = true;
				$scope.companylist = response.data;
			});
		}
		$scope.loadCompanies();
	}
	company.controller('companyCtrl', function($scope, $http) {

		$http.get("/user")
		.then(function(response) {
			$scope.userData = response.data.userData;
			$scope.name = response.data.userData.first_name + ' ' + response.data.userData.last_name;
			companyController();
		});	
	});
</script>
